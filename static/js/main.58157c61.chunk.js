(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{13:function(e,t,a){e.exports=a(21)},18:function(e,t,a){},19:function(e,t,a){},21:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),l=a(5),s=a.n(l),o=(a(18),a(10)),i=a(2),c=a(6),u=a(7),m=a(11),f=a(8),p=a(1),d=a(12),v=(a(19),a(9)),h=function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];return(a=Object(m.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(r)))).state={field:a.getSmthFromStorage("field",[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]]),currentScore:+a.getSmthFromStorage("currentScore",0),bestScore:+a.getSmthFromStorage("bestScore",0),isGameActive:a.getSmthFromStorage("isActive",!1),isWin:a.getSmthFromStorage("isWin","false"),isLose:a.getSmthFromStorage("isLose",!1)},a.handleKeyDown=a.handleKeyDown.bind(Object(p.a)(a)),a}return Object(d.a)(t,e),Object(u.a)(t,[{key:"componentWillMount",value:function(){document.addEventListener("keydown",this.handleKeyDown)}},{key:"componentDidMount",value:function(){this.state.isGameActive||(this.spawnTiles(2),this.setState({isGameActive:!0}))}},{key:"spawnTiles",value:function(e){for(var t=this,a=this.state.field,n=[],r=[],l=0;l<4;l++)for(var s=0;s<4;s++)0===a[l][s]&&n.push([l,s]);for(var c=0;c<e;c++){var u=Math.floor(Math.random()*n.length);r.push(n.splice(u,1)[0])}this.setState(function(e){for(var a=Object(i.a)(e.field),n=0,l=r;n<l.length;n++){var s=l[n],c=Object(o.a)(s,2),u=c[0],m=c[1];a[u][m]=t.generateNewTileValue()}return{field:a}},function(){var e=t.state.field;t.isLose(e)&&(localStorage.setItem("isLose","true"),t.setState({isLose:!0,isActive:!1})),localStorage.setItem("field",JSON.stringify(e)),localStorage.setItem("isActive","true")})}},{key:"generateNewTileValue",value:function(){return 1===Math.floor(10*Math.random())+1?4:2}},{key:"handleKeyDown",value:function(e){var t=e.key;["ArrowDown","ArrowUp","ArrowLeft","ArrowRight"].includes(t)&&(e.preventDefault(),this.handleMove(t))}},{key:"handleMove",value:function(e){var t=this,a=this.state.field,n=[];if("ArrowRight"===e||"ArrowLeft"===e)for(var r=0;r<4;r++){var l=a[r].filter(function(e){return e>0});for(l=this.collapseSameTiles(l,e);l.length<4;)"ArrowRight"===e?l.unshift(0):"ArrowLeft"===e&&l.push(0);n.push(l)}else if("ArrowUp"===e||"ArrowDown"===e){for(var s=[[],[],[],[]],o=0;o<4;o++)for(var i=0;i<4;i++)0!==a[o][i]&&s[i].push(a[o][i]);for(var c=0;c<4;c++){var u=s[c].filter(function(e){return e>0});for(u=this.collapseSameTiles(u,e);u.length<4;)"ArrowDown"===e?u.unshift(0):"ArrowUp"===e&&u.push(0);s[c]=u}n=[[],[],[],[]];for(var m=0;m<4;m++)for(var f=0;f<4;f++)n[m].push(s[f][m])}Object(v.isEqual)(a,n)||this.setState({field:n},function(){t.spawnTiles(1)})}},{key:"collapseSameTiles",value:function(e,t){var a=Object(i.a)(e);if("ArrowRight"===t||"ArrowDown"===t)for(var n=a.length-1;n>0;n--)a[n]===a[n-1]&&(a[n]+=a[n],a[n-1]=0,this.applyWithNewTileCollapsed(a[n]));else if("ArrowLeft"===t||"ArrowUp"===t)for(var r=0;r<a.length-1;r++)a[r]===a[r+1]&&(a[r]+=a[r],a[r+1]=0,this.applyWithNewTileCollapsed(a[r]));return a=a.filter(function(e){return e>0})}},{key:"applyWithNewTileCollapsed",value:function(e){var t=this;this.setState(function(a){var n,r=a.currentScore+e;return localStorage.setItem("currentScore",r),r>a.bestScore&&localStorage.setItem("bestScore",r),"false"===a.isWin&&2048===e?(document.removeEventListener("keydown",t.handleKeyDown),n="true"):n="keep"===a.isWin?"keep":a.isWin,localStorage.setItem("isWin",JSON.stringify(n)),{currentScore:r,bestScore:r>a.bestScore?r:a.bestScore,isWin:n}})}},{key:"isLose",value:function(e){for(var t=0;t<4;t++)for(var a=0;a<4;a++){if(0===e[t][a])return!1;if(e[t][a]===e[t][a+1])return!1;if(3!==t&&e[t][a]===e[t+1][a])return!1}return!0}},{key:"newGameHandler",value:function(){var e=this,t=this.state.isWin;localStorage.setItem("currentScore","0"),localStorage.setItem("isWin",'"false"'),localStorage.setItem("isLose","false"),"true"===t&&document.addEventListener("keydown",this.handleKeyDown),this.setState({field:[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],currentScore:0,isWin:"false",isLose:!1},function(){e.spawnTiles(2)})}},{key:"keepGoingHandler",value:function(){document.addEventListener("keydown",this.handleKeyDown),localStorage.setItem("isWin",'"keep"'),this.setState({isWin:"keep"})}},{key:"getSmthFromStorage",value:function(e,t){var a=localStorage.getItem(e);return a=a?JSON.parse(a):t}},{key:"render",value:function(){var e=this,t=this.state,a=t.field,n=t.currentScore,l=t.bestScore,s=t.isLose,o=t.isWin;return r.a.createElement("div",{className:"App"},r.a.createElement("div",{className:"App-nav"},r.a.createElement("div",{className:"App-nav-status-bar"},r.a.createElement("span",{className:"App-nav-status-bar-2048-label"},"2048"),r.a.createElement("div",{className:"App-nav-status-bar-score-table"},r.a.createElement("div",{className:"App-nav-status-bar-score-table-cur"},r.a.createElement("p",null,"SCORE"),r.a.createElement("span",null,n)),r.a.createElement("div",{className:"App-nav-status-bar-score-table-best"},r.a.createElement("p",null,"BEST"),r.a.createElement("span",null,l)))),r.a.createElement("p",{className:"App-nav-restart-bar"},r.a.createElement("span",{className:"App-nav-restart-bar-join-label"},"Join the numbers and get to the ",r.a.createElement("b",null,"2048 tile!")),r.a.createElement("button",{className:"App-nav-restart-bar-join-btn",onClick:function(){return e.newGameHandler()}},"New Game"))),r.a.createElement("div",{className:"App-field"},s&&r.a.createElement("div",{className:"App-field-lose-modal"},r.a.createElement("div",{className:"App-field-lose-modal-message"},r.a.createElement("p",null,"Game over!"),r.a.createElement("button",{onClick:function(){return e.newGameHandler()}},"Try again"))),"true"===o&&r.a.createElement("div",{className:"App-field-win-modal"},r.a.createElement("div",{className:"App-field-win-modal-message"},r.a.createElement("p",null,"You win!"),r.a.createElement("button",{onClick:function(){return e.keepGoingHandler()}},"Keep going"),r.a.createElement("button",{onClick:function(){return e.newGameHandler()}},"Try again"))),a.map(function(e,t){return r.a.createElement("div",{key:"row ".concat(t),className:"App-field-row"},e.map(function(e,a){return r.a.createElement("div",{key:"cell ".concat(t,"_").concat(a),className:"App-field-cell"},e>0&&r.a.createElement("div",{className:"App-field-cell-tile","data-tile-value":e},e))}))})))}}]),t}(n.Component);s.a.render(r.a.createElement(h,null),document.getElementById("root"))}},[[13,1,2]]]);
//# sourceMappingURL=main.58157c61.chunk.js.map